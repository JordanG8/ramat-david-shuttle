<!doctype html>
<html lang="he" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>לוח בקרה — שאטל כנף 1</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;700;900&family=Rubik:wght@400;500;600;700&display=swap"
      rel="stylesheet" />
  </head>
  <body>
    <!-- ─── Login Screen ─── -->
    <div id="login-screen">
      <div class="login-card">
        <div class="login-logo">
          <div class="login-logo-icon">
            <svg
              width="32"
              height="32"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2">
              <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
              <path d="M7 11V7a5 5 0 0 1 10 0v4" />
            </svg>
          </div>
          <div class="login-title">לוח בקרה — ניהול שאטל</div>
          <div class="login-subtitle">כנף 1 — בסיס רמת דוד</div>
        </div>

        <form class="login-form" id="login-form" autocomplete="off">
          <div class="form-group">
            <label class="form-label" for="pwd-input">סיסמת ניהול</label>
            <input
              type="password"
              id="pwd-input"
              class="form-input"
              placeholder="הכנס סיסמה..."
              autocomplete="current-password"
              required />
          </div>
          <div class="login-error" id="login-error">סיסמה שגויה. נסה שנית.</div>
          <button type="submit" class="btn btn-primary btn-full" id="login-btn">
            כניסה למערכת
          </button>
          <div
            class="text-muted text-sm"
            style="text-align: center; margin-top: 4px">
            סיסמה ראשונית: <strong>admin2024!</strong>
          </div>
        </form>
      </div>
    </div>

    <!-- ─── Dashboard (hidden until login) ─── -->
    <div id="dashboard" style="display: none">
      <!-- Header -->
      <header class="adm-header">
        <div class="adm-header-brand">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="white"
            stroke-width="2">
            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
            <polyline points="9 22 9 12 15 12 15 22" />
          </svg>
          <div>
            <div class="adm-header-title">לוח בקרה — שאטל כנף 1</div>
            <div class="adm-header-sub">ניהול לוחות זמנים ותחנות</div>
          </div>
        </div>
        <div class="adm-header-actions">
          <span class="adm-status-badge" id="save-status">שמור שינויים</span>
          <a
            href="index.html"
            class="btn btn-secondary btn-sm"
            style="
              background: rgba(255, 255, 255, 0.15);
              color: #fff;
              border-color: rgba(255, 255, 255, 0.2);
            ">
            חזרה לאתר
          </a>
          <button
            class="btn btn-secondary btn-sm"
            id="logout-btn"
            style="
              background: rgba(255, 255, 255, 0.1);
              color: #fff;
              border-color: rgba(255, 255, 255, 0.15);
            ">
            התנתק
          </button>
        </div>
      </header>

      <div class="adm-body">
        <!-- Sidebar -->
        <nav class="adm-sidebar">
          <div class="adm-sidebar-label">ניהול</div>
          <button class="adm-tab-btn active" data-tab="units">
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2">
              <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
              <circle cx="9" cy="7" r="4" />
              <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
              <path d="M16 3.13a4 4 0 0 1 0 7.75" />
            </svg>
            יחידות ותחנות
          </button>
          <button class="adm-tab-btn" data-tab="routes">
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2">
              <rect x="1" y="3" width="15" height="13" rx="2" />
              <path d="M16 8h4l3 3v3H16V8z" />
              <circle cx="5.5" cy="18.5" r="2.5" />
              <circle cx="18.5" cy="18.5" r="2.5" />
            </svg>
            קווי שאטל
          </button>
          <button class="adm-tab-btn" data-tab="schedules">
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
              <line x1="16" y1="2" x2="16" y2="6" />
              <line x1="8" y1="2" x2="8" y2="6" />
              <line x1="3" y1="10" x2="21" y2="10" />
            </svg>
            לוחות זמנים
          </button>
          <div class="adm-sidebar-label">מערכת</div>
          <button class="adm-tab-btn" data-tab="settings">
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2">
              <circle cx="12" cy="12" r="3" />
              <path
                d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z" />
            </svg>
            הגדרות
          </button>
        </nav>

        <!-- Main Content -->
        <main class="adm-main" id="adm-main">
          <!-- ══ Units Tab ══ -->
          <div class="tab-panel active" id="tab-units">
            <div class="tab-page-header">
              <div>
                <div class="tab-page-title">יחידות ותחנות</div>
                <div class="tab-page-sub">עריכת יחידות, מחלקות וסוגי תחנות</div>
              </div>
              <div class="flex-row">
                <button class="btn btn-primary" id="save-units-btn">
                  שמור שינויים
                </button>
                <button class="btn btn-secondary" id="add-unit-btn">
                  + הוסף יחידה
                </button>
              </div>
            </div>
            <div id="units-list"></div>
          </div>

          <!-- ══ Routes Tab ══ -->
          <div class="tab-panel" id="tab-routes">
            <div class="tab-page-header">
              <div>
                <div class="tab-page-title">קווי שאטל</div>
                <div class="tab-page-sub">
                  עריכת תחנות עצירה ושעות יציאה לכל קו
                </div>
              </div>
              <button class="btn btn-primary" id="save-routes-btn">
                שמור שינויים
              </button>
            </div>
            <div id="routes-list"></div>
          </div>

          <!-- ══ Schedules Tab ══ -->
          <div class="tab-panel" id="tab-schedules">
            <div class="tab-page-header">
              <div>
                <div class="tab-page-title">לוחות זמנים מלאים</div>
                <div class="tab-page-sub">עריכת לוחות נסיעה מפורטים לפי קו</div>
              </div>
              <button class="btn btn-primary" id="save-schedules-btn">
                שמור שינויים
              </button>
            </div>
            <div id="schedules-list"></div>
          </div>

          <!-- ══ Settings Tab ══ -->
          <div class="tab-panel" id="tab-settings">
            <div class="tab-page-header">
              <div>
                <div class="tab-page-title">הגדרות מערכת</div>
                <div class="tab-page-sub">אבטחה, ניהול נתונים וייצוא</div>
              </div>
            </div>

            <div class="settings-grid">
              <div class="settings-card">
                <div class="settings-card-title">
                  <svg
                    width="18"
                    height="18"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2">
                    <rect x="3" y="11" width="18" height="11" rx="2" />
                    <path d="M7 11V7a5 5 0 0 1 10 0v4" />
                  </svg>
                  שינוי סיסמה
                </div>
                <div class="settings-card-desc">
                  שנה את סיסמת הניהול של לוח הבקרה.
                </div>
                <div class="form-group">
                  <label>סיסמה נוכחית</label>
                  <input
                    type="password"
                    class="form-control"
                    id="old-pwd"
                    placeholder="סיסמה נוכחית"
                    style="direction: ltr; text-align: left" />
                </div>
                <div class="form-group">
                  <label>סיסמה חדשה</label>
                  <input
                    type="password"
                    class="form-control"
                    id="new-pwd"
                    placeholder="סיסמה חדשה"
                    style="direction: ltr; text-align: left" />
                </div>
                <div class="form-group">
                  <label>אימות סיסמה חדשה</label>
                  <input
                    type="password"
                    class="form-control"
                    id="confirm-pwd"
                    placeholder="חזור על הסיסמה החדשה"
                    style="direction: ltr; text-align: left" />
                </div>
                <button class="btn btn-primary" id="change-pwd-btn">
                  עדכן סיסמה
                </button>
              </div>

              <div class="settings-card">
                <div class="settings-card-title">
                  <svg
                    width="18"
                    height="18"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2">
                    <polyline points="1 4 1 10 7 10" />
                    <path d="M3.51 15a9 9 0 1 0 .49-3.16" />
                  </svg>
                  איפוס לנתונים מקוריים
                </div>
                <div class="settings-card-desc">
                  מחיקת כל השינויים והחזרה לנתוני ברירת המחדל. פעולה זו אינה
                  ניתנת לביטול.
                </div>
                <button class="btn btn-danger" id="reset-btn">
                  איפוס לנתוני ברירת מחדל
                </button>
              </div>

              <div class="settings-card">
                <div class="settings-card-title">
                  <svg
                    width="18"
                    height="18"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                    <polyline points="7 10 12 15 17 10" />
                    <line x1="12" y1="15" x2="12" y2="3" />
                  </svg>
                  ייצוא נתונים
                </div>
                <div class="settings-card-desc">
                  הורד את כל הנתונים הנוכחיים כקובץ JSON לגיבוי.
                </div>
                <button class="btn btn-secondary" id="export-btn">
                  ייצוא JSON
                </button>
              </div>

              <div class="settings-card">
                <div class="settings-card-title">
                  <svg
                    width="18"
                    height="18"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                    <polyline points="17 8 12 3 7 8" />
                    <line x1="12" y1="3" x2="12" y2="15" />
                  </svg>
                  ייבוא נתונים
                </div>
                <div class="settings-card-desc">
                  טען קובץ JSON שיוצא קודם לכן לשחזור נתונים.
                </div>
                <input
                  type="file"
                  id="import-file"
                  accept=".json"
                  style="display: none" />
                <button class="btn btn-secondary" id="import-btn">
                  ייבוא מקובץ JSON
                </button>
              </div>
            </div>

            <div class="adm-section" style="margin-top: 8px">
              <div class="adm-section-header">
                <div class="adm-section-title">מידע על הנתונים</div>
              </div>
              <div class="adm-section-body">
                <div id="data-info" class="text-sm text-muted"></div>
              </div>
            </div>
          </div>
          <!-- end settings -->
        </main>
      </div>
    </div>

    <!-- Toast container -->
    <div id="toast-container"></div>

    <!-- Load app data first (for defaults), then admin logic -->
    <script type="module" src="app.js"></script>
    <script type="module" src="admin.js"></script>
  </body>
</html>
