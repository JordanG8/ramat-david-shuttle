// ═══════════════════════════════════════════
// RAMAT DAVID SHUTTLE — APP
// ═══════════════════════════════════════════

const DATA = {
  "title": "מקרא תחנות הכנף",
  "legend": {
    "תחנת_שירות": "מחלקה שהיא עצמה תחנה (ירוק)",
    "תחנה_חלופית": "מחלקה שנוסעת לתחנה מסוימת (צהוב)"
  },
  "units": [
    {
      "name": "כללי",
      "departments": [
        { "name": "רחבת היסעים", "type": "תחנת שירות" }
      ]
    },
    {
      "name": "טייסת 109",
      "departments": [
        { "name": "דת\"ק 13", "type": "תחנת שירות" },
        { "name": "דת\"ק 16", "type": "תחנת שירות" },
        { "name": "דת\"ק 12", "type": "תחנת שירות" },
        { "name": "דת\"ק 15", "type": "תחנה חלופית", "goes_to": "גף טיסה 109" },
        { "name": "דת\"ק 8", "type": "תחנת שירות" },
        { "name": "גף טיסה", "type": "תחנת שירות" },
        { "name": "גף טכני", "type": "תחנת שירות" }
      ]
    },
    {
      "name": "טייסת 160",
      "station": "רחבת היסעים",
      "departments": [
        { "name": "גף טיסה", "type": "תחנת שירות" },
        { "name": "גף טכני", "type": "תחנת שירות" },
        { "name": "דת\"ק 2", "type": "תחנת שירות" }
      ]
    },
    {
      "name": "טייסת 105",
      "departments": [
        { "name": "דת\"ק 14", "type": "תחנה חלופית", "goes_to": "דת\"ק 34" },
        { "name": "דת\"ק 9", "type": "תחנת שירות" },
        { "name": "דת\"ק 7", "type": "תחנת שירות" },
        { "name": "גף טיסה", "type": "תחנת שירות" },
        { "name": "גף טכני", "type": "תחנת שירות" }
      ]
    },
    {
      "name": "טייסת 144",
      "departments": [
        { "name": "מפקדה", "type": "תחנה חלופית", "goes_to": "רחבת הסיעים" },
        { "name": "דת\"ק 32", "type": "תחנת שירות" },
        { "name": "בריטניה", "type": "תחנת שירות" }
      ]
    },
    {
      "name": "טייסת 101",
      "station": "רחבת היסעים",
      "departments": [
        { "name": "דת\"ק 5", "type": "תחנת שירות" },
        { "name": "דת\"ק 4", "type": "תחנת שירות" },
        { "name": "דת\"ק 3", "type": "תחנת שירות" },
        { "name": "גף טיסה", "type": "תחנת שירות" },
        { "name": "גף טכני", "type": "תחנת שירות" }
      ]
    },
    {
      "name": "טייסת תעופה",
      "station": "רחבת היסעים",
      "departments": [
        { "name": "דת\"ק 17", "type": "תחנת שירות" },
        { "name": "מפקדה", "type": "תחנת שירות" },
        { "name": "אבטחת מידע", "type": "תחנה חלופית", "goes_to": "רחבת היסעים" },
        { "name": "אבטחה פיזית", "type": "תחנה חלופית", "goes_to": "רחבת היסעים" },
        { "name": "כיבוי", "type": "תחנה חלופית", "goes_to": "רחבת היסעים" },
        { "name": "רציפו\"ת תפקודית", "type": "תחנה חלופית", "goes_to": "רחבת היסעים" },
        { "name": "מושל\"ם", "type": "תחנת שירות" }
      ]
    },
    {
      "name": "בינוי 302",
      "station": "רחבת היסעים",
      "departments": [
        { "name": "מגדל", "type": "תחנת שירות" },
        { "name": "מפקדה", "type": "תחנה חלופית", "goes_to": "רחבת היסעים" },
        { "name": "מערכות חשמל", "type": "תחנה חלופית", "goes_to": "רחבת היסעים" },
        { "name": "משאבים/רכב", "type": "תחנה חלופית", "goes_to": "רחבת היסעים" },
        { "name": "מערכות מיזוג", "type": "תחנה חלופית", "goes_to": "רחבת היסעים" },
        { "name": "מש\"ק", "type": "תחנה חלופית", "goes_to": "רחבת היסעים" },
        { "name": "הנדסה", "type": "תחנה חלופית", "goes_to": "רחבת היסעים" },
        { "name": "מערכות דס\"ל/דלק 21", "type": "תחנה חלופית", "goes_to": "רחבת היסעים" },
        { "name": "שירותי קרקע", "type": "תחנת שירות" }
      ]
    },
    {
      "name": "לשכה",
      "departments": [
        { "name": "לשכת כנף 1", "type": "תחנת שירות" },
        { "name": "בטיחות", "type": "תחנת שירות" },
        { "name": "משרד סוציולוגית", "type": "תחנת שירות" }
      ]
    },
    {
      "name": "מנהלה",
      "station": "רחבת היסעים",
      "departments": [
        { "name": "כח אדם חובה/סגל", "type": "תחנה חלופית", "goes_to": "רחבת היסעים" },
        { "name": "לוגיסטיקה", "type": "תחנת שירות" },
        { "name": "רבנות", "type": "תחנה חלופית", "goes_to": "רחבת היסעים" },
        { "name": "רס\"ר", "type": "תחנה חלופית", "goes_to": "רחבת היסעים" },
        { "name": "רפואה", "type": "תחנה חלופית", "goes_to": "רחבת היסעים" },
        { "name": "פסיכולוגיה", "type": "תחנת שירות" },
        { "name": "שפ\"ו", "type": "תחנה חלופית", "goes_to": "רחבת היסעים" },
        { "name": "תזונה", "type": "תחנה חלופית", "goes_to": "רחבת היסעים" }
      ]
    },
    {
      "name": "טייסת תחזוקה",
      "notes": "רכבות - איסוף מתחנת מערכות, חד\"א - מעבר בכלל התחנות",
      "departments": [
        { "name": "מרכז אחזקה", "type": "תחנת שירות" },
        { "name": "מנועים", "type": "תחנה חלופית", "goes_to": "רכבות" },
        { "name": "מערכות", "type": "תחנה חלופית", "goes_to": "רכבות" },
        { "name": "מוסכים א/ב", "type": "תחנה חלופית", "goes_to": "רכבות" },
        { "name": "אוהד", "type": "תחנה חלופית", "goes_to": "רכבות" },
        { "name": "גל\"א", "type": "תחנה חלופית", "goes_to": "רכבות" },
        { "name": "אוויוניקה", "type": "תחנה חלופית", "goes_to": "רכבות" },
        { "name": "מבנה", "type": "תחנה חלופית", "goes_to": "רכבות" },
        { "name": "תקשוב", "type": "תחנה חלופית", "goes_to": "רכבות" },
        { "name": "חילוץ", "type": "תחנה חלופית", "goes_to": "רכבות" },
        { "name": "נשמ\"ת", "type": "תחנת שירות" },
        { "name": "מרכז בידונים", "type": "תחנת שירות" }
      ]
    }
  ],
  "bus_routes": [
    {
      "name": "קו 1 - ראשון עד חמישי",
      "phone": "04-6092400",
      "schedule": [
        { "time": "6:00-7:00", "type": "איסוף", "description": "איסוף ע\"פ קריאה מול מוצב מנהלה" },
        { "time": "7:20", "type": "נסיעה", "stops": ["רחבת היסעים","קולנוע","דת\"ק 17","דת\"ק 2","מגדל","גף טיסה 105","גף טכני 105","מתחם בידונים","דת\"ק 34","דת\"ק 32","דת\"ק 9","בריטניה","רחבת היסעים"] },
        { "time": "7:40", "type": "נסיעה", "stops": ["רחבת היסעים","קולנוע","דת\"ק 17","דת\"ק 2","מגדל","גף טיסה 105","גף טכני 105","מתחם בידונים","דת\"ק 34","דת\"ק 32","דת\"ק 9","בריטניה","רחבת היסעים"] },
        { "time": "8:00", "type": "נסיעה", "stops": ["רחבת היסעים","צומת הנת דוד","ש\"ג קדמי"] },
        { "time": "8:20", "type": "נסיעה", "stops": ["רחבת היסעים","מערכות (איסוף מרכז של תחנות תחזוקה - מפורט במקרא)","דת\"ק 13","דת\"ק 12","גף טכני 160","דת\"ק 7","דת\"ק 8","דלק 21","דת\"ק 16","נשמ\"ת","גף טכני 109","גף טיסה 109","רכבת כפר יהושע"] },
        { "time": "8:40", "type": "נסיעה", "stops": ["רכבת כפר יהושע","גף טכני 109","גף טיסה 109","נשמ\"ת","דת\"ק 7","דת\"ק 8","דלק 21","גף טכני 160","דת\"ק 12","דת\"ק 13","דת\"ק 16","שירותי קרקע","גף אוהד","גל\"א","גף אוויוניקה","גף מבנה","מרכז אחזקה","מוסכים א/ב","מנועים","חילוץ","רחבת היסעים","קולנוע","דת\"ק 17","דת\"ק 2","גף טיסה 105","גף טכני 105","מתחם בידונים","מגדל","דת\"ק 34","דת\"ק 32","דת\"ק 9","בריטניה","רחבת היסעים"] },
        { "time": "9:20-10:00", "type": "הפסקה" },
        { "time": "10:00", "type": "נסיעה", "stops": ["רחבת היסעים","קולנוע","דת\"ק 17","דת\"ק 2","מגדל","גף טכני 105","גף טיסה 105","מתחם בידונים","דת\"ק 34","דת\"ק 32","דת\"ק 9","בריטניה","רחבת היסעים"] },
        { "time": "10:30", "type": "נסיעה", "stops": ["רחבת היסעים","מערכות (איסוף מרכז של תחנות תחזוקה - מפורט במקרא)","דת\"ק 13","דת\"ק 12","גף טכני 160","דת\"ק 7","דת\"ק 8","דלק 21","דת\"ק 16","נשמ\"ת","גף טכני 109","גף טיסה 109"] },
        { "time": "11:00", "type": "נסיעה", "stops": ["גף טיסה 109","גף טכני 109","נשמ\"ת","דת\"ק 8","דת\"ק 7","דלק 21","גף טכני 160","דת\"ק 12","דת\"ק 13","דת\"ק 16","חד\"א"] },
        { "time": "11:20", "type": "נסיעה", "stops": ["גף טיסה 109","גף טכני 109","נשמ\"ת","דת\"ק 8","דת\"ק 7","דלק 21","גף טכני 160","דת\"ק 12","דת\"ק 13","דת\"ק 16","חד\"א"] },
        { "time": "11:30-12:00", "type": "הפסקה" },
        { "time": "12:05", "type": "נסיעה", "stops": ["חד\"א","גף מנועים","גף מערכות","שירותי קרקע","גף אוהד","גל\"א","גף אוויוניקה","גף מבנה","מרכז אחזקה","מוסכים א/ב","חילוץ","חד\"א"] },
        { "time": "12:20", "type": "נסיעה", "stops": ["חד\"א","רחבת היסעים","דת\"ק 16","דת\"ק 13","דת\"ק 12","גף טכני 160","דלק 21","דת\"ק 7","דת\"ק 8","נשמ\"ת","גף טיסה 109","גף טכני 109","חד\"א"] },
        { "time": "13:00", "type": "נסיעה", "stops": ["חד\"א","גף מנועים","גף מערכות","שירותי קרקע","גף אוהד","גל\"א","גף אוויוניקה","גף מבנה","מרכז אחזקה","מוסכים א/ב","חילוץ"] },
        { "time": "13:30", "type": "נסיעה", "stops": ["חד\"א","רחבת היסעים","דת\"ק 16","דת\"ק 13","דת\"ק 12","גף טכני 160","דלק 21","דת\"ק 7","דת\"ק 8","נשמ\"ת","גף טיסה 109","גף טכני 109"] },
        { "time": "13:45-14:30", "type": "הפסקה" },
        { "time": "14:30", "type": "נסיעה", "stops": ["רחבת היסעים","מערכות (איסוף מרכז של תחנות תחזוקה - מפורט במקרא)","דת\"ק 13","דת\"ק 12","גף טכני 160","דת\"ק 7","דת\"ק 8","דלק 21","דת\"ק 16","נשמ\"ת","גף טכני 109","גף טיסה 109","רכבת כפר יהושע"] },
        { "time": "14:45", "type": "נסיעה", "stops": ["רכבת כפר יהושע","גף טכני 109","גף טיסה 109","נשמ\"ת","דת\"ק 7","דת\"ק 8","דלק 21","גף טכני 160","דת\"ק 12","דת\"ק 13","דת\"ק 16","שירותי קרקע","גף אוהד","גל\"א","גף אוויוניקה","גף מבנה","מרכז אחזקה","מוסכים א/ב","מנועים","חילוץ","רחבת היסעים","קולנוע","דת\"ק 17","דת\"ק 2","גף טיסה 105","גף טכני 105","מתחם בידונים","מגדל","דת\"ק 34","דת\"ק 32","דת\"ק 9","בריטניה","רחבת היסעים"] },
        { "time": "15:30", "type": "נסיעה", "stops": ["רחבת היסעים","מערכות (איסוף מרכז של תחנות תחזוקה - מפורט במקרא)","דת\"ק 13","דת\"ק 12","גף טכני 160","דת\"ק 7","דת\"ק 8","דלק 21","דת\"ק 16","נשמ\"ת","גף טכני 109","גף טיסה 109","רכבת כפר יהושע"] },
        { "time": "16:10", "type": "נסיעה", "stops": ["רכבת כפר יהושע","גף טכני 109","גף טיסה 109","נשמ\"ת","דת\"ק 7","דת\"ק 8","דלק 21","גף טכני 160","דת\"ק 12","דת\"ק 13","דת\"ק 16","שירותי קרקע","גף אוהד","גל\"א","גף אוויוניקה","גף מבנה","מרכז אחזקה","מוסכים א/ב","מנועים","חילוץ","רחבת היסעים","קולנוע","דת\"ק 17","דת\"ק 2","גף טיסה 105","גף טכני 105","מתחם בידונים","מגדל","דת\"ק 34","דת\"ק 32","דת\"ק 9","בריטניה","רחבת היסעים"] },
        { "time": "16:30", "type": "נסיעה", "stops": ["רחבת היסעים","מערכות (איסוף מרכז של תחנות תחזוקה - מפורט במקרא)","דת\"ק 13","דת\"ק 12","גף טכני 160","דת\"ק 7","דת\"ק 8","דלק 21","דת\"ק 16","נשמ\"ת","גף טכני 109","גף טיסה 109","רכבת כפר יהושע"] },
        { "time": "17:10", "type": "נסיעה", "stops": ["רכבת כפר יהושע","גף טכני 109","גף טיסה 109","נשמ\"ת","דת\"ק 7","דת\"ק 8","דלק 21","גף טכני 160","דת\"ק 12","דת\"ק 13","דת\"ק 16","שירותי קרקע","גף אוהד","גל\"א","גף אוויוניקה","גף מבנה","מרכז אחזקה","מוסכים א/ב","מנועים","חילוץ","רחבת היסעים"] },
        { "time": "18:00", "type": "סוף יום" }
      ]
    },
    {
      "name": "קו 2 - ראשון עד חמישי",
      "phone": "04-6092400",
      "schedule": [
        { "time": "6:30-7:00", "type": "איסוף", "description": "איסוף ע\"פ קריאה מול מוצב מנהלה" },
        { "time": "7:20", "type": "נסיעה", "stops": ["רחבת היסעים","מערכות (איסוף מרכז של תחנות תחזוקה - מפורט במקרא)","דת\"ק 13","דת\"ק 12","גף טכני 160","דת\"ק 7","דת\"ק 8","דלק 21","דת\"ק 16","נשמ\"ת","גף טכני 109","גף טיסה 109","רכבת כפר יהושע"] },
        { "time": "7:40", "type": "נסיעה", "stops": ["רכבת כפר יהושע","גף טכני 109","גף טיסה 109","נשמ\"ת","דת\"ק 7","דת\"ק 8","דלק 21","גף טכני 160","דת\"ק 12","דת\"ק 13","דת\"ק 16","שירותי קרקע","גף אוהד","גל\"א","גף אוויוניקה","גף מבנה","מרכז אחזקה","מוסכים א/ב","מנועים","חילוץ","רחבת היסעים","קולנוע","דת\"ק 17","דת\"ק 2","גף טיסה 105","גף טכני 105","מתחם בידונים","מגדל","דת\"ק 34","דת\"ק 32","דת\"ק 9","בריטניה","רחבת היסעים"] },
        { "time": "8:30", "type": "נסיעה", "stops": ["צומת רמת דוד","רחבת היסעים","קולנוע","דת\"ק 17","דת\"ק 2","מגדל","גף טיסה 105","גף טכני 105","מתחם בידונים","דת\"ק 34","דת\"ק 32","דת\"ק 9","בריטניה","רחבת היסעים","צומת רמת דוד"] },
        { "time": "9:00", "type": "נסיעה", "stops": ["צומת רמת דוד","רחבת היסעים","מערכות (איסוף מרכז של תחנות תחזוקה - מפורט במקרא)","דת\"ק 16","דת\"ק 13","דת\"ק 12","גף טכני 160","דת\"ק 7","דת\"ק 8","דלק 21","גף טכני 109","גף טיסה 109","צומת רמת דוד"] },
        { "time": "9:30", "type": "נסיעה", "stops": ["צומת רמת דוד","רחבת היסעים","קולנוע","דת\"ק 17","דת\"ק 2","מגדל","גף טיסה 105","גף טכני 105","מתחם בידונים","דת\"ק 34","דת\"ק 32","דת\"ק 9","בריטניה","רחבת היסעים","צומת רמת דוד"] },
        { "time": "10:15", "type": "נסיעה", "stops": ["צומת רמת דוד","רחבת היסעים","קולנוע","דת\"ק 17","דת\"ק 2","מגדל","גף טיסה 105","גף טכני 105","מתחם בידונים","דת\"ק 34","דת\"ק 32","דת\"ק 9","בריטניה"] },
        { "time": "10:30-11:00", "type": "הפסקה" },
        { "time": "11:00", "type": "נסיעה", "stops": ["בריטניה","דת\"ק 9","דת\"ק 32","דת\"ק 34","מגדל","מתחם בידונים","דת\"ק 2","דת\"ק 17","חד\"א"] },
        { "time": "11:20", "type": "נסיעה", "stops": ["חד\"א","גף מנועים","מתחם בידונים","שירותי קרקע","גף אוהד","גל\"א","גף אוויוניקה","גף מבנה","מרכז אחזקה","מוסכים א/ב","חילוץ","חד\"א"] },
        { "time": "11:30-12:00", "type": "הפסקה" },
        { "time": "12:10", "type": "נסיעה", "stops": ["חד\"א","רחבת היסעים","דת\"ק 17","דת\"ק 2","מתחם בידונים","גף טכני 105","גף טיסה 105","מגדל","דת\"ק 34","דת\"ק 32","דת\"ק 9","בריטניה"] },
        { "time": "12:20", "type": "נסיעה", "stops": ["בריטניה","דת\"ק 9","דת\"ק 32","דת\"ק 34","מגדל","מתחם בידונים","דת\"ק 2","דת\"ק 17","חד\"א"] },
        { "time": "12:30-13:15", "type": "הפסקה" },
        { "time": "13:20", "type": "נסיעה", "stops": ["חד\"א","רחבת היסעים","דת\"ק 17","דת\"ק 2","מתחם בידונים","גף טכני 105","גף טיסה 105","מגדל","דת\"ק 34","דת\"ק 32","דת\"ק 9","בריטניה"] },
        { "time": "14:10", "type": "נסיעה", "stops": ["רחבת היסעים","קולנוע","דת\"ק 17","דת\"ק 2","מגדל","גף טיסה 105","גף טכני 105","מתחם בידונים","דת\"ק 34","דת\"ק 32","דת\"ק 9","בריטניה","רחבת היסעים"] },
        { "time": "14:40", "type": "נסיעה", "stops": ["רחבת היסעים","קולנוע","דת\"ק 17","דת\"ק 2","מגדל","גף טיסה 105","גף טכני 105","מתחם בידונים","דת\"ק 34","דת\"ק 32","דת\"ק 9","בריטניה","רחבת היסעים"] },
        { "time": "15:10", "type": "נסיעה", "stops": ["רחבת היסעים","קולנוע","דת\"ק 17","דת\"ק 2","מגדל","גף טיסה 105","גף טכני 105","מתחם בידונים","דת\"ק 34","דת\"ק 32","דת\"ק 9","בריטניה","רחבת היסעים"] },
        { "time": "15:40-16:10", "type": "הפסקה" }
      ]
    },
    {
      "name": "קו 3 - ראשון עד חמישי",
      "phone": "04-6092400",
      "schedule": [
        { "time": "10:00", "type": "נסיעה", "stops": ["צומת רמת דוד","רחבת היסעים","מערכות (איסוף מרכז של תחנות תחזוקה - מפורט במקרא)","דת\"ק 16","דת\"ק 13","דת\"ק 12","גף טכני 160","דת\"ק 7","דת\"ק 8","דלק 21","נשמ\"ת","גף טכני 109","גף טיסה 109","צומת רמת דוד"] },
        { "time": "10:30", "type": "נסיעה", "stops": ["צומת רמת דוד","רחבת היסעים","מערכות (איסוף מרכז של תחנות תחזוקה - מפורט במקרא)","דת\"ק 16","דת\"ק 13","דת\"ק 12","גף טכני 160","דת\"ק 7","דת\"ק 8","דלק 21","נשמ\"ת","גף טכני 109","גף טיסה 109","צומת רמת דוד"] },
        { "time": "11:00", "type": "נסיעה", "stops": ["צומת רמת דוד","רחבת היסעים","מערכות (איסוף מרכז של תחנות תחזוקה - מפורט במקרא)","דת\"ק 16","דת\"ק 13","דת\"ק 12","גף טכני 160","דת\"ק 7","דת\"ק 8","דלק 21","נשמ\"ת","גף טכני 109","גף טיסה 109","צומת רמת דוד"] },
        { "time": "11:30-12:00", "type": "הפסקה" },
        { "time": "12:10", "type": "נסיעה", "stops": ["צומת רמת דוד","רחבת היסעים","מערכות (איסוף מרכז של תחנות תחזוקה - מפורט במקרא)","דת\"ק 16","דת\"ק 13","דת\"ק 12","גף טכני 160","דת\"ק 7","דת\"ק 8","דלק 21","נשמ\"ת","גף טכני 109","גף טיסה 109","צומת רמת דוד"] },
        { "time": "12:40", "type": "נסיעה", "stops": ["צומת רמת דוד","רחבת היסעים","מערכות (איסוף מרכז של תחנות תחזוקה - מפורט במקרא)","דת\"ק 16","דת\"ק 13","דת\"ק 12","גף טכני 160","דת\"ק 7","דת\"ק 8","דלק 21","נשמ\"ת","גף טכני 109","גף טיסה 109","צומת רמת דוד"] },
        { "time": "13:10", "type": "נסיעה", "stops": ["צומת רמת דוד","רחבת היסעים","מערכות (איסוף מרכז של תחנות תחזוקה - מפורט במקרא)","דת\"ק 16","דת\"ק 13","דת\"ק 12","גף טכני 160","דת\"ק 7","דת\"ק 8","דלק 21","נשמ\"ת","גף טכני 109","גף טיסה 109","צומת רמת דוד"] },
        { "time": "13:40-14:00", "type": "הפסקה" },
        { "time": "14:10", "type": "נסיעה", "stops": ["צומת רמת דוד","רחבת היסעים","מערכות (איסוף מרכז של תחנות תחזוקה - מפורט במקרא)","דת\"ק 16","דת\"ק 13","דת\"ק 12","גף טכני 160","דת\"ק 7","דת\"ק 8","דלק 21","נשמ\"ת","גף טכני 109","גף טיסה 109","צומת רמת דוד"] },
        { "time": "14:40", "type": "נסיעה", "stops": ["צומת רמת דוד","רחבת היסעים","מערכות (איסוף מרכז של תחנות תחזוקה - מפורט במקרא)","דת\"ק 16","דת\"ק 13","דת\"ק 12","גף טכני 160","דת\"ק 7","דת\"ק 8","דלק 21","נשמ\"ת","גף טכני 109","גף טיסה 109","צומת רמת דוד"] },
        { "time": "15:10", "type": "נסיעה", "stops": ["צומת רמת דוד","רחבת היסעים","מערכות (איסוף מרכז של תחנות תחזוקה - מפורט במקרא)","דת\"ק 16","דת\"ק 13","דת\"ק 12","גף טכני 160","דת\"ק 7","דת\"ק 8","דלק 21","נשמ\"ת","גף טכני 109","גף טיסה 109","צומת רמת דוד"] },
        { "time": "15:40", "type": "נסיעה", "stops": ["צומת רמת דוד","רחבת היסעים","מערכות (איסוף מרכז של תחנות תחזוקה - מפורט במקרא)","דת\"ק 16","דת\"ק 13","דת\"ק 12","גף טכני 160","דת\"ק 7","דת\"ק 8","דלק 21","נשמ\"ת","גף טכני 109","גף טיסה 109","צומת רמת דוד"] },
        { "time": "16:10", "type": "נסיעה", "stops": ["צומת רמת דוד","רחבת היסעים","מערכות (איסוף מרכז של תחנות תחזוקה - מפורט במקרא)","דת\"ק 16","דת\"ק 13","דת\"ק 12","גף טכני 160","דת\"ק 7","דת\"ק 8","דלק 21","נשמ\"ת","גף טכני 109","גף טיסה 109","צומת רמת דוד"] },
        { "time": "16:40", "type": "נסיעה", "stops": ["צומת רמת דוד","רחבת היסעים","מערכות (איסוף מרכז של תחנות תחזוקה - מפורט במקרא)","דת\"ק 16","דת\"ק 13","דת\"ק 12","גף טכני 160","דת\"ק 7","דת\"ק 8","דלק 21","נשמ\"ת","גף טכני 109","גף טיסה 109","צומת רמת דוד"] },
        { "time": "17:30-18:00", "type": "הפסקה" },
        { "time": "18:00-20:40", "type": "איסוף", "description": "איסוף ע\"פ קריאה מול מוצב מנהלה" },
        { "time": "20:40-21:00", "type": "הפסקה" },
        { "time": "21:00-21:45", "type": "איסוף", "description": "איסוף ע\"פ קריאה מול מוצב מנהלה" },
        { "time": "22:00", "type": "סוף יום" }
      ]
    },
    {
      "name": "קו 4 - תגבור רכבות ראשון וחמישי",
      "schedule": [
        { "time": "7:20", "type": "נסיעה", "stops": ["רחבת היסעים","מערכות (איסוף מרכז של תחנות תחזוקה - מפורט במקרא)","דת\"ק 16","דת\"ק 13","דת\"ק 12","גף טכני 160","דת\"ק 7","דת\"ק 8","דלק 21","נשמ\"ת","גף טכני 109","גף טיסה 109","רכבת כפר יהושע"] },
        { "time": "7:40", "type": "נסיעה", "stops": ["רכבת כפר יהושע","גף טכני 109","גף טיסה 109","נשמ\"ת","דת\"ק 7","דת\"ק 8","דלק 21","גף טכני 160","דת\"ק 12","דת\"ק 13","דת\"ק 16","שירותי קרקע","גף אוהד","גל\"א","גף אוויוניקה","גף מבנה","מרכז אחזקה","מוסכים א/ב","מנועים","חילוץ","רחבת היסעים","קולנוע","דת\"ק 17","דת\"ק 2","גף טיסה 105","גף טכני 105","מתחם בידונים","מגדל","דת\"ק 34","דת\"ק 32","דת\"ק 9","בריטניה","רחבת היסעים"] },
        { "time": "8:20", "type": "נסיעה", "stops": ["רחבת היסעים","מערכות (איסוף מרכז של תחנות תחזוקה - מפורט במקרא)","דת\"ק 16","דת\"ק 13","דת\"ק 12","גף טכני 160","דת\"ק 7","דת\"ק 8","דלק 21","נשמ\"ת","גף טכני 109","גף טיסה 109","רכבת כפר יהושע"] },
        { "time": "8:40", "type": "נסיעה", "stops": ["רכבת כפר יהושע","גף טכני 109","גף טיסה 109","נשמ\"ת","דת\"ק 7","דת\"ק 8","דלק 21","גף טכני 160","דת\"ק 12","דת\"ק 13","דת\"ק 16","שירותי קרקע","גף אוהד","גל\"א","גף אוויוניקה","גף מבנה","מרכז אחזקה","מוסכים א/ב","מנועים","חילוץ","רחבת היסעים","קולנוע","דת\"ק 17","דת\"ק 2","גף טיסה 105","גף טכני 105","מתחם בידונים","מגדל","דת\"ק 34","דת\"ק 32","דת\"ק 9","בריטניה","רחבת היסעים"] },
        { "time": "9:20", "type": "נסיעה", "stops": ["רחבת היסעים","מערכות (איסוף מרכז של תחנות תחזוקה - מפורט במקרא)","דת\"ק 16","דת\"ק 13","דת\"ק 12","גף טכני 160","דת\"ק 7","דת\"ק 8","דלק 21","נשמ\"ת","גף טכני 109","גף טיסה 109","רכבת כפר יהושע"] },
        { "time": "9:40", "type": "נסיעה", "stops": ["רכבת כפר יהושע","גף טכני 109","גף טיסה 109","נשמ\"ת","דת\"ק 7","דת\"ק 8","דלק 21","גף טכני 160","דת\"ק 12","דת\"ק 13","דת\"ק 16","שירותי קרקע","גף אוהד","גל\"א","גף אוויוניקה","גף מבנה","מרכז אחזקה","מוסכים א/ב","מנועים","חילוץ","רחבת היסעים","קולנוע","דת\"ק 17","דת\"ק 2","גף טיסה 105","גף טכני 105","מתחם בידונים","מגדל","דת\"ק 34","דת\"ק 32","דת\"ק 9","בריטניה","רחבת היסעים"] },
        { "time": "10:20", "type": "נסיעה", "stops": ["רחבת היסעים","מערכות (איסוף מרכז של תחנות תחזוקה - מפורט במקרא)","דת\"ק 16","דת\"ק 13","דת\"ק 12","גף טכני 160","דת\"ק 7","דת\"ק 8","דלק 21","נשמ\"ת","גף טכני 109","גף טיסה 109","רכבת כפר יהושע","נשמ\"ת"] },
        { "time": "10:40", "type": "נסיעה", "stops": ["רכבת כפר יהושע","גף טכני 109","גף טיסה 109","נשמ\"ת","דת\"ק 7","דת\"ק 8","דלק 21","גף טכני 160","דת\"ק 12","דת\"ק 13","דת\"ק 16","שירותי קרקע","גף אוהד","גל\"א","גף אוויוניקה","גף מבנה","מרכז אחזקה","מוסכים א/ב","מנועים","חילוץ","רחבת היסעים","קולנוע","דת\"ק 17","דת\"ק 2","גף טיסה 105","גף טכני 105","מתחם בידונים","מגדל","דת\"ק 34","דת\"ק 32","דת\"ק 9","בריטניה","רחבת היסעים"] },
        { "time": "11:30-12:30", "type": "הפסקה" },
        { "time": "12:30", "type": "נסיעה", "stops": ["רחבת היסעים","מערכות (איסוף מרכז של תחנות תחזוקה - מפורט במקרא)","דת\"ק 16","דת\"ק 13","דת\"ק 12","גף טכני 160","דת\"ק 7","דת\"ק 8","דלק 21","נשמ\"ת","גף טכני 109","גף טיסה 109","רכבת כפר יהושע"] },
        { "time": "13:00", "type": "נסיעה", "stops": ["רכבת כפר יהושע","גף טכני 109","גף טיסה 109","נשמ\"ת","דת\"ק 7","דת\"ק 8","דלק 21","גף טכני 160","דת\"ק 12","דת\"ק 13","דת\"ק 16","שירותי קרקע","גף אוהד","גל\"א","גף אוויוניקה","גף מבנה","מרכז אחזקה","מוסכים א/ב","מנועים","חילוץ","רחבת היסעים"] },
        { "time": "13:35", "type": "נסיעה", "stops": ["רחבת היסעים","מערכות (איסוף מרכז של תחנות תחזוקה - מפורט במקרא)","דת\"ק 16","דת\"ק 13","דת\"ק 12","גף טכני 160","דת\"ק 7","דת\"ק 8","דלק 21","נשמ\"ת","גף טכני 109","גף טיסה 109","רכבת כפר יהושע"] },
        { "time": "14:05", "type": "נסיעה", "stops": ["רכבת כפר יהושע","גף טכני 109","גף טיסה 109","נשמ\"ת","דת\"ק 7","דת\"ק 8","דלק 21","גף טכני 160","דת\"ק 12","דת\"ק 13","דת\"ק 16","שירותי קרקע","גף אוהד","גל\"א","גף אוויוניקה","גף מבנה","מרכז אחזקה","מוסכים א/ב","מנועים","חילוץ","רחבת היסעים"] },
        { "time": "14:20-14:45", "type": "הפסקה" },
        { "time": "14:50", "type": "נסיעה", "stops": ["רחבת היסעים","מערכות (איסוף מרכז של תחנות תחזוקה - מפורט במקרא)","דת\"ק 16","דת\"ק 13","דת\"ק 12","גף טכני 160","דת\"ק 7","דת\"ק 8","דלק 21","נשמ\"ת","גף טכני 109","גף טיסה 109","רכבת כפר יהושע"] },
        { "time": "15:20", "type": "נסיעה", "stops": ["רכבת כפר יהושע","גף טכני 109","גף טיסה 109","נשמ\"ת","דת\"ק 7","דת\"ק 8","דלק 21","גף טכני 160","דת\"ק 12","דת\"ק 13","דת\"ק 16","שירותי קרקע","גף אוהד","גל\"א","גף אוויוניקה","גף מבנה","מרכז אחזקה","מוסכים א/ב","מנועים","חילוץ","רחבת היסעים"] },
        { "time": "15:50", "type": "נסיעה", "stops": ["רחבת היסעים","מערכות (איסוף מרכז של תחנות תחזוקה - מפורט במקרא)","דת\"ק 16","דת\"ק 13","דת\"ק 12","גף טכני 160","דת\"ק 7","דת\"ק 8","דלק 21","נשמ\"ת","גף טכני 109","גף טיסה 109","רכבת כפר יהושע"] },
        { "time": "16:30", "type": "נסיעה", "stops": ["רכבת כפר יהושע","גף טכני 109","גף טיסה 109","נשמ\"ת","דת\"ק 7","דת\"ק 8","דלק 21","גף טכני 160","דת\"ק 12","דת\"ק 13","דת\"ק 16","שירותי קרקע","גף אוהד","גל\"א","גף אוויוניקה","גף מבנה","מרכז אחזקה","מוסכים א/ב","מנועים","חילוץ","רחבת היסעים"] },
        { "time": "16:50", "type": "נסיעה", "stops": ["רחבת היסעים","מערכות (איסוף מרכז של תחנות תחזוקה - מפורט במקרא)","דת\"ק 16","דת\"ק 13","דת\"ק 12","גף טכני 160","דת\"ק 7","דת\"ק 8","דלק 21","נשמ\"ת","גף טכני 109","גף טיסה 109","רכבת כפר יהושע"] },
        { "time": "17:30", "type": "נסיעה", "stops": ["רכבת כפר יהושע","גף טכני 109","גף טיסה 109","נשמ\"ת","דת\"ק 7","דת\"ק 8","דלק 21","גף טכני 160","דת\"ק 12","דת\"ק 13","דת\"ק 16","שירותי קרקע","גף אוהד","גל\"א","גף אוויוניקה","גף מבנה","מרכז אחזקה","מוסכים א/ב","מנועים","חילוץ","רחבת היסעים"] },
        { "time": "סוף יום", "type": "סוף יום" }
      ]
    }
  ]
};

// ─── Helpers ───
function esc(str) {
  const div = document.createElement('div');
  div.textContent = str;
  return div.innerHTML;
}

const chevronSVG = `<svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>`;
const smallChevronSVG = `<svg class="tl-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>`;
const arrowSVG = `<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>`;

// ─── Render Stations ───
function renderStations() {
  const container = document.getElementById('stations-list');
  container.innerHTML = DATA.units.map(unit => {
    const deptCount = unit.departments.length;
    const stationBadge = unit.station
      ? `<span class="unit-station-badge">${esc(unit.station)}</span>`
      : '';
    const noteHtml = unit.notes
      ? `<div class="unit-note"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>${esc(unit.notes)}</div>`
      : '';

    const deptsHtml = unit.departments.map(dept => {
      const isService = dept.type === 'תחנת שירות';
      const dotClass = isService ? 'service' : 'alt';
      const goesTo = dept.goes_to
        ? `<span class="dept-goes-to">${arrowSVG} ${esc(dept.goes_to)}</span>`
        : '';
      return `
        <div class="dept-item">
          <div class="dept-info">
            <span class="dept-dot ${dotClass}"></span>
            <span class="dept-name">${esc(dept.name)}</span>
          </div>
          ${goesTo}
        </div>`;
    }).join('');

    return `
      <div class="unit-card">
        <div class="unit-header" onclick="this.parentElement.classList.toggle('open')">
          <div class="unit-title">
            ${esc(unit.name)}
            <span class="unit-count">${deptCount}</span>
            ${stationBadge}
          </div>
          <div class="unit-meta">
            ${chevronSVG}
          </div>
        </div>
        <div class="unit-body">
          ${noteHtml}
          <div class="dept-list">
            ${deptsHtml}
          </div>
        </div>
      </div>`;
  }).join('');
}

// ─── Render Routes ───
let activeRoute = 0;

function renderRouteTabs() {
  const container = document.getElementById('route-tabs');
  container.innerHTML = DATA.bus_routes.map((route, i) => {
    const label = route.name.split(' - ')[0] || route.name;
    return `<button class="route-tab ${i === 0 ? 'active' : ''}" data-route="${i}">${esc(label)}</button>`;
  }).join('');

  container.addEventListener('click', (e) => {
    const btn = e.target.closest('.route-tab');
    if (!btn) return;
    activeRoute = parseInt(btn.dataset.route);
    container.querySelectorAll('.route-tab').forEach(t => t.classList.remove('active'));
    btn.classList.add('active');
    renderRouteContent();
  });
}

function renderRouteContent() {
  const route = DATA.bus_routes[activeRoute];
  const container = document.getElementById('route-content');

  const phoneHtml = route.phone
    ? `<div class="route-phone"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72c.127.96.361 1.903.7 2.81a2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0 1 22 16.92z"/></svg>${route.phone}</div>`
    : '';

  const headerHtml = `
    <div class="route-header">
      <div class="route-name">${esc(route.name)}</div>
      ${phoneHtml}
    </div>`;

  const timelineHtml = route.schedule.map(entry => {
    const type = entry.type;

    if (type === 'הפסקה') {
      return `
        <div class="tl-entry break-entry">
          <div class="tl-dot"></div>
          <div class="tl-time">${esc(entry.time)}</div>
          <div class="tl-break">הפסקה</div>
        </div>`;
    }

    if (type === 'איסוף') {
      return `
        <div class="tl-entry pickup">
          <div class="tl-dot"></div>
          <div class="tl-time">${esc(entry.time)}</div>
          <div class="tl-pickup">${esc(entry.description || 'איסוף')}</div>
        </div>`;
    }

    if (type === 'סוף יום') {
      return `
        <div class="tl-entry end">
          <div class="tl-dot"></div>
          <div class="tl-time">${esc(entry.time)}</div>
          <div class="tl-end">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><line x1="9" y1="9" x2="15" y2="15"/><line x1="15" y1="9" x2="9" y2="15"/></svg>
            סוף יום
          </div>
        </div>`;
    }

    // נסיעה
    const stops = entry.stops || [];
    const stopsHtml = stops.map((stop, i) =>
      `<div class="stop-item"><span class="stop-num">${i + 1}</span>${esc(stop)}</div>`
    ).join('');

    return `
      <div class="tl-entry trip">
        <div class="tl-dot"></div>
        <div class="tl-time">${esc(entry.time)}</div>
        <div class="tl-card" onclick="this.classList.toggle('open')">
          <div class="tl-card-header">
            <span class="tl-type-badge trip-badge">נסיעה</span>
            <span class="tl-stop-count">${stops.length} תחנות</span>
            ${smallChevronSVG}
          </div>
          <div class="tl-stops">
            <div class="tl-stops-inner">
              ${stopsHtml}
            </div>
          </div>
        </div>
      </div>`;
  }).join('');

  container.innerHTML = headerHtml + `<div class="timeline">${timelineHtml}</div>`;
}

// ─── Tab Navigation ───
function initTabs() {
  const tabs = document.querySelectorAll('.nav-tab');
  tabs.forEach(tab => {
    tab.addEventListener('click', () => {
      tabs.forEach(t => t.classList.remove('active'));
      tab.classList.add('active');
      document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
      document.getElementById(`${tab.dataset.tab}-panel`).classList.add('active');
    });
  });
}

// ─── Init ───
document.addEventListener('DOMContentLoaded', () => {
  renderStations();
  renderRouteTabs();
  renderRouteContent();
  initTabs();
});
